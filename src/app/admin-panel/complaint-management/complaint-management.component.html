<p-toast></p-toast>
<p-confirmDialog></p-confirmDialog>
<div class="layout-wrapper" [ngClass]="containerClass">
  <app-topbar></app-topbar>
  <div class="layout-sidebar">
      <app-sidebar></app-sidebar>
  </div>
  <div class="layout-main-container">
      <div class="layout-main">
      <div class="container-fluid">
        <div class="card">
          <h5 class="card-title fw-semibold mb-4">complaints list</h5>

        </div>
        <div class="card">
          <div class="card-body">
            <p-table [value]="loadedcom">
              <ng-template pTemplate="header">
                <tr>
                  <th>Date</th>
                  <th>Subject</th>
                  <th>department</th>
                  <th>description</th>
                  <th>Status</th>
                  <th>Action</th>


                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-loadedcom>
                <tr>
                  <td>{{ loadedcom.createdAt  | date:'dd/MM/yyyy' }}</td>
                  <td>{{ loadedcom.subject }}</td>
                  <td>{{ loadedcom.department }}</td>
                  <td>{{ loadedcom.description }}</td>



                  <td> 
                    <p-tag
                    *ngIf="loadedcom.status === 'treated'"
                    severity="success"
                    value="{{ loadedcom.status }}"
                  >
                  </p-tag>
                  <p-tag
                    *ngIf="loadedcom.status === 'waiting'"
                    severity="warning"
                    value="{{ loadedcom.status }}"
                  >
                  </p-tag>
                  </td>

                  <td>  <button pButton pRipple type="button" icon="pi pi-search" (click)="showDialog(loadedcom)" class="p-button-rounded p-button-primary p-button-text"></button>
                    <button pButton pRipple type="button" icon="pi pi-trash"   (click)="deleteComplaint(loadedcom)"
                    class="p-button-rounded p-button-danger p-button-text"></button>
                </tr>
              </ng-template>
            </p-table>          </div>
        </div>           </div>
        <p-dialog
        header="Header"
        [(visible)]="visible"
        [breakpoints]="{ '960px': '75vw' }"
        [style]="{ width: '50vw' }"
        [draggable]="false"
        [resizable]="false"
      >
        <div class="surface-section">
          <div class="font-medium text-3xl text-900 mb-3">Request details</div>
          <ul class="list-none p-0 m-0">
            <li
              class="flex align-items-center py-3 px-2 border-top-1 surface-border flex-wrap"
            >
              <div class="text-500 w-6 md:w-2 font-medium">created At</div>
              <div class="text-900 w-full md:w-8 md:flex-order-0 flex-order-1">
                {{ selectedComplaints?.createdAt | date : "dd/MM/yyyy" }}
              </div>
              <div class="w-6 md:w-2 flex justify-content-end"></div>
            </li>
            <li
              class="flex align-items-center py-3 px-2 border-top-1 surface-border flex-wrap"
            >
              <div class="text-500 w-6 md:w-2 font-medium">status</div>
              <div class="text-900 w-full md:w-8 md:flex-order-0 flex-order-1">
                <p-chip
                  label="{{ selectedComplaints?.status }}"
                  class="mr-2"
                ></p-chip>
              </div>
              <div class="w-6 md:w-2 flex justify-content-end"></div>
            </li>
            <li
              class="flex align-items-center py-3 px-2 border-top-1 surface-border flex-wrap"
            >
              <div class="text-500 w-6 md:w-2 font-medium">subject</div>
              <div class="text-900 w-full md:w-8 md:flex-order-0 flex-order-1">
                <td>{{ selectedComplaints?.subject }}</td>
              </div>
              <div class="w-6 md:w-2 flex justify-content-end"></div>
            </li>
            <li
              class="flex align-items-center py-3 px-2 border-top-1 surface-border flex-wrap"
            >
              <div class="text-500 w-6 md:w-2 font-medium">department</div>
              <div class="text-900 w-full md:w-8 md:flex-order-0 flex-order-1">
                {{ selectedComplaints?.department }}
              </div>
              <div class="w-6 md:w-2 flex justify-content-end"></div>
            </li>
            <li
              class="flex align-items-center py-3 px-2 border-top-1 border-bottom-1 surface-border flex-wrap"
            >
              <div class="text-500 w-6 md:w-2 font-medium">description</div>
              <div
                class="text-900 w-full md:w-8 md:flex-order-0 flex-order-1 line-height-3"
              >
                {{ selectedComplaints?.description }}
              </div>
            </li>
          </ul>
        </div>
        <ng-template pTemplate="footer">
          <p-button
            icon="pi pi-check"
            (click)="visible = false"
            (click)="confirmMarkAsTreated()"
            label="mark as treated"
            pAutoFocus
            [autofocus]="true"
          ></p-button>
          <p-button
            icon="pi pi-send"
            (click)="visible = false"
            label="send email"
            pAutoFocus
            [autofocus]="true"
          ></p-button>
        </ng-template>
      </p-dialog>
      <app-footer></app-footer>
  </div>
  <app-config></app-config>
  <div class="layout-mask"></div>
</div>